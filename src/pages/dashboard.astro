---
import Layout from "@/layouts/Layout.astro";
import DashboardView from "@/components/dashboard/DashboardView.tsx";
import MainToolbar from "@/components/common/MainToolbar";

export const prerender = false;

// Get authenticated user from middleware
const user = Astro.locals.user;

// Redirect to login if not authenticated (middleware should handle this, but just in case)
if (!user) {
  return Astro.redirect("/auth/login");
}

const breadcrumbs = [{ label: "Dashboard", href: undefined }];
---

<Layout title="Dashboard">
  <MainToolbar client:load user={user} breadcrumbs={breadcrumbs} />
  <DashboardView client:load />
</Layout>
